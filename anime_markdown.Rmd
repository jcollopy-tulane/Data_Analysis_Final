---
title: "Anime Data"
author: "John Collopy"
date: "9/21/2023"
output: html_document
---

Introduction:



Step 1: Data Collection

Our dataset can be found [here](https://www.kaggle.com/datasets/hernan4444/anime-recommendation-database-2020) on Kaggle. We chose to use this dataset for our project because it contains features conducive to the goal of our project.

Here is the list of features contained in the dataset:

1. MAL_ID: MyAnimelist ID of the anime. (e.g. 1)
2. Name: full name of the anime. (e.g. Cowboy Bebop)
3. Score: average score of the anime given from all users in MyAnimelist database. (e.g. 8.78)
4. Genres: comma separated list of genres for this anime. (e.g. Action, Adventure, Comedy, Drama, Sci-Fi, Space)
5. English name: full name in english of the anime. (e.g. Cowboy Bebop)
6. Japanese name: full name in japanses of the anime. (e.g. カウボーイビバップ)
7. Type: TV, movie, OVA, etc. (e.g. TV)
8. Episodes': number of chapters. (e.g. 26)
9. Aired: broadcast date. (e.g. Apr 3, 1998 to Apr 24, 1999)
10. Premiered: season premiere. (e.g. Spring 1998)
11. Producers: comma separated list of produducers (e.g. Bandai Visual)
12. Licensors: comma separated list of licensors (e.g. Funimation, Bandai Entertainment)
13. Studios: comma separated list of studios (e.g. Sunrise)
14. Source: Manga, Light novel, Book, etc. (e.g Original)
15. Duration: duration of the anime per episode (e.g 24 min. per ep.)
16. Rating: age rate (e.g. R - 17+ (violence & profanity))
17. Ranked: position based in the score. (e.g 28)
18. Popularity: position based in the the number of users who have added the anime to their list. (e.g 39)
19. Members: number of community members that are in this anime's "group". (e.g. 1251960)
20. Favorites: number of users who have the anime as "favorites". (e.g. 61,971)
21. Watching: number of users who are watching the anime. (e.g. 105808)
22. Completed: number of users who have complete the anime. (e.g. 718161)
23. On-Hold: number of users who have the anime on Hold. (e.g. 71513)
24. Dropped: number of users who have dropped the anime. (e.g. 26678)
25. Plan to Watch': number of users who plan to watch the anime. (e.g. 329800)
26. Score-10': number of users who scored 10. (e.g. 229170)
27. Score-9': number of users who scored 9. (e.g. 182126)
28. Score-8': number of users who scored 8. (e.g. 131625)
29. Score-7': number of users who scored 7. (e.g. 62330)
30. Score-6': number of users who scored 6. (e.g. 20688)
31. Score-5': number of users who scored 5. (e.g. 8904)
32. Score-4': number of users who scored 4. (e.g. 3184)
33. Score-3': number of users who scored 3. (e.g. 1357)
34. Score-2': number of users who scored 2. (e.g. 741)
35. Score-1': number of users who scored 1. (e.g. 1580)

Below: we upload the dataset and view the first 5 rows.
```{r}
anime <- read.csv("anime.csv")
head(anime)
```

Step 2: ETL

Our data now needs to be prepared for modeling. The first column to amend is the "Genres" column. First, let's check what type of data the column contains.

```{r}
typeof(anime$Genres)
```

Now, let's see what different genres are in this column.

```{r}
# Finding the unique Genres in the Genres column
unique_genres <- unique(anime$Genres)
unique_genres[1:10]
```



```{r}
replace_genres <- function(genre_list) {
  
  genre_list <- gsub("Martial Arts", "MartialArts", genre_list)
  genre_list <- gsub("Slice of Life", "SliceofLife", genre_list)
  return(genre_list)
}

anime$Genres <- lapply(anime$Genres, function(genre_list) replace_genres(genre_list))
```

```{r}
# Putting the items in "Genres" column into a list

anime$Genres_List <- lapply(anime$Genres, function(x) unlist(strsplit(x, ", ")))
```

```{r}
#Finding the Genre that appears the most

unlisted_strings <- unlist(anime$Genres_List)
string_frequencies <- table(unlisted_strings)

# Convert the frequency table to a data frame
frequency_df <- as.data.frame(string_frequencies)

# Rename the columns
colnames(frequency_df) <- c("String", "Frequency")

# Print the frequency data frame
sorted_data <- frequency_df[order(-frequency_df$Frequency), ]

# Print the sorted data frame
print(sorted_data)
```

```{r}
# Need to get rid of Hentai, Ecchi, Harem, Yaoi, Yuri
```

```{r}
# Getting Rid of the weirdo genres
anime <- anime[!grepl("Hentai", anime$Genres),]
anime <- anime[!grepl("Ecchi", anime$Genres),]
anime <- anime[!grepl("Harem", anime$Genres),]
anime <- anime[!grepl("Yaoi", anime$Genres),]
anime <- anime[!grepl("Yuri", anime$Genres),]
```


```{r}
# Making the Year_Premiered Column

anime$Year_Premiered <- ifelse(anime$Premiered == "Unknown",
                         "Unknown",
                         sub(".* (\\d{4})", "\\1", anime$Premiered))
```

```{r}
anime$Year_Premiered
```


```{r}
breaks <- c(0,1, 10, 30, 60, Inf) 

anime$bin_episodes <- cut(as.integer(anime$Episodes), breaks = breaks)
item_counts <- table(anime$bin_episodes)
item_counts
#hist_data <- hist(anime$bin_episodes, main = "Histogram", xlab = "Bins", ylab = #"Frequency")
```

```{r}
unknown_count <- sum(anime$Episodes == "Unknown")
unknown_count
```

